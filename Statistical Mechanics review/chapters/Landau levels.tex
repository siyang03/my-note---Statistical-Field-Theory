\chapter{Landau levels} \label{A}
\section{separation of variables method}
\begin{itemize}
	\item Landau 考虑了电子在磁场 $\vec{B} = B \hat{e}_z, \vec{A} = \frac{1}{2} \big( - B y \hat{e}_x + B x \hat{e}_y \big)$ 中的运动, 但忽略自旋, 电子的 Hamiltonian 为
	\begin{equation}
		H = \frac{1}{2 m} \Big( \vec{p} + e \vec{A} \Big)^2 = \frac{|\vec{p}|^2}{2 m} + \frac{e B}{2 m} \hat{L}_z + \frac{e^2}{2 m} |\vec{A}|^2.
	\end{equation}
	
	\item 使用 cylindrical coordinates,
	\begin{equation}
		\begin{dcases}
			r = \sqrt{x^2 + y^2} \\
			\tan \phi = \frac{y}{x} \\
			z = z
		\end{dcases} \Longrightarrow \begin{dcases}
			\nabla^2 = \frac{\partial^2}{\partial r^2} + \frac{1}{r} \frac{\partial}{\partial r} + \frac{1}{r^2} \frac{\partial^2}{\partial \phi^2} + \frac{\partial^2}{\partial z^2} \\
			\hat{L}_z = - i \hbar \frac{\partial}{\partial \phi}
		\end{dcases},
	\end{equation}
	因此, 本征值方程为
	\begin{equation}
		\Big( - \frac{\hbar^2}{2 m} \Big( \frac{\partial^2}{\partial r^2} + \frac{1}{r} \frac{\partial}{\partial r} + \frac{1}{r^2} \frac{\partial^2}{\partial \phi^2} + \frac{\partial^2}{\partial z^2} \Big) - i \hbar \omega_L \frac{\partial}{\partial \phi} + \frac{1}{2} m \omega_L^2 r^2 - \epsilon \Big) \psi(r, \phi, z) = 0,
	\end{equation}
	其中 $\omega_L = \frac{e B}{2 m}$	是 Larmor frequency.
	
	\item 分离变量 $\psi(r, \phi, z) = e^{i p_z z / \hbar} e^{i l \phi} R_{l, p_z}(r), l \in \mathbb{Z}$, 并令
	\begin{equation}
		\begin{dcases}
			\frac{\hbar^2 \kappa_l^2}{2 m} = \epsilon - \hbar \omega_L l - \frac{p_z^2}{2 m} \\
			\frac{1}{\kappa_l^4} \Big( \frac{m \omega_L}{\hbar} \Big)^2 = \alpha^2 \\
			\rho = \kappa_l r \\
		\end{dcases},
	\end{equation}
	那么, radial equation 为
	\begin{equation}
		\rho^2 R'' + \rho R' + (\rho^2 - l^2 - \alpha^2 \rho^4) R = 0.
	\end{equation}
\end{itemize}

\subsection{asymptotic solution}
\begin{itemize}
	\item 考虑 $\rho \gg |l|$ 的区间,
	\begin{equation}
		\rho^2 R'' + \rho R' - \alpha^2 \rho^4 R \simeq 0,
	\end{equation}
	试探解 $R \sim e^{- k_\alpha \rho^2}$, 代入
	\begin{equation}
		(4 k_\alpha^2 - \alpha^2) \rho^4 - 4 k_\alpha \rho^2 \simeq 0,
	\end{equation}
	忽略 $O(\rho^2)$, 得到
	\begin{equation}
		R \sim e^{- \frac{\alpha}{2} \rho^2}.
	\end{equation}
	
	\item 再考虑 $\rho \ll |l|$ 的区间,
	\begin{equation}
		\rho^2 R'' + \rho R' - l^2 R = 0,
	\end{equation}
	试探解 $R \sim \rho^m$, 代入
	\begin{equation}
		m^2 - l^2 = 0 \Longrightarrow m = \pm l,
	\end{equation}
	舍去非物理的解,
	\begin{equation}
		R \sim \rho^{|l|}.
	\end{equation}
\end{itemize}

\subsection{solve the radial equation}
\begin{itemize}
	\item 令 $R = \rho^{|l|} e^{- \frac{\alpha}{2} \rho^2} u(\rho^2)$, 代入, 并令 $x = \alpha \rho^2$, 那么
	\begin{equation}
		x u'' + (|l| + 1 - x) u' + \frac{1}{4 \alpha} (1 - 2 \alpha - 2 \alpha |l|) u = 0,
	\end{equation}
	如果 $\frac{1}{4 \alpha} (1 - 2 \alpha - 2 \alpha |l|) = n_r \geq 0 \in \mathbb{Z}$, 那么可以得到精确解,
	\begin{equation}
		R = \rho^{|l|} e^{- \frac{\alpha}{2} \rho^2} L_{n_r}^{(|l|)}(\alpha \rho^2),
	\end{equation}
	其中 $L_{n_r}^{(|l|)}(x)$ 是 \href{https://en.wikipedia.org/wiki/Laguerre_polynomials#Generalized_Laguerre_polynomials}{generalized Laguerre polynomial}.
	
	\item 对应的 energy eigenvalue 为
	\begin{equation} \label{A.1.14}
		\epsilon = 2 \hbar \omega_L \Big( n_r + \theta(l) l + \frac{1}{2} \Big) + \frac{p_z^2}{2 m}, \quad \text{with} \quad \begin{dcases}
			n_r \in \mathbb{Z}_{\geq 0} \\
			l \in \mathbb{Z}
		\end{dcases}.
	\end{equation}
\end{itemize}

\section{ladder operator method}
\begin{itemize}
	\item 令
	\begin{equation}
		\begin{dcases}
			a = \frac{1}{\sqrt{2}} (a_x - i a_y) \\
			b = \frac{1}{\sqrt{2}} (a_x + i a_y)
		\end{dcases}, \quad \text{where} \quad a_i = \sqrt{\frac{m \omega_L}{2 \hbar}} \Big( x_i + \frac{i}{m \omega_L} p_i \Big), \quad i = x, y,
	\end{equation}
	那么 $a, b$ 满足
	\begin{equation}
		[a, a^\dag] = [b, b^\dag] = 1, \quad [a, b] = [a, b^\dag] = 0.
	\end{equation}
	
	\begin{tcolorbox}[title=calculation:]
		\begin{equation}
			\begin{dcases}
				[a, a^\dag] = \frac{1}{2} ([a_x, a^\dag_x] + [a_y, a^\dag_y]) = 1 \\
				[b, b^\dag] = \frac{1}{2} ([a_x, a^\dag_x] + [a_y, a^\dag_y]) = 1 \\
				[a, b^\dag] = \frac{1}{2} ([a_x, a^\dag_x] - [a_y, a^\dag_y]) = 0
			\end{dcases}.
		\end{equation}
	\end{tcolorbox}
	
	\item 角动量算符 $\hat{L}_z$ 可以写作
	\begin{equation}
		\hat{L}_z = - i \hbar (a^\dag_x a_y - a_x a^\dag_y) = \hbar (a^\dag a - b^\dag b).
	\end{equation}
	
	\item 电子的 Hamiltonian (通过因式分解) 可以写作
	\begin{align}
		H &= \frac{|\vec{p}|^2}{2 m} + \omega_L (x p_y - y p_x) + \frac{1}{2} m \omega_L^2 (x^2 + y^2) \notag \\
		&= \frac{p_z^2}{2 m} + \Big( \frac{p_x^2 + p_y^2}{2 m} + \omega_L (x p_y - y p_x) + \frac{1}{2} m \omega_L^2 (x^2 + y^2) \Big) \notag \\
		&= \frac{p_z^2}{2 m} + \Big( \frac{p_x + i p_y}{\sqrt{2 m}} + i \sqrt{\frac{m}{2}} \omega_L (x + i y) \Big) \Big( \frac{p_x - i p_y}{\sqrt{2 m}} - i \sqrt{\frac{m}{2}} \omega_L (x - i y) \Big) + \hbar \omega_L \notag \\
		&= \frac{p_z^2}{2 m} + 2 \hbar \omega_L \Big( a^\dag a + \frac{1}{2} \Big).
	\end{align}
	
	\item 因此, 系统的能量本征态为
	\begin{equation}
		\ket{p_z} \otimes (a^\dag)^{n_a} \ket{0}_a \otimes (b^\dag)^{n_b} \ket{0}_b, \quad \text{with} \quad \begin{dcases}
			n_a \in \mathbb{Z}_{\geq 0} \\
			n_b \in \mathbb{Z}_{\geq 0}
		\end{dcases},
	\end{equation}
	其本征值为
	\begin{equation}
		\begin{dcases}
			\text{energy} & 2 \hbar \omega_L \Big( n_a + \frac{1}{2} \Big) + \frac{p_z^2}{2 m} \\
			\text{angular momentum} & \hbar l = \hbar (n_a - n_b)
		\end{dcases}.
	\end{equation}
	\begin{itemize}
		\item 与 \eqref{A.1.14} 有对应关系
		\begin{equation}
			\begin{dcases}
				n_a = n_r + \theta(l) l \geq n_r \\
				n_b = n_r - \theta(- l) l \geq n_r
			\end{dcases}.
		\end{equation}
	\end{itemize}
\end{itemize}

\section{energy level degeneracy}
\begin{itemize}
	\item 电子能级的简并度为
	\begin{equation}
		g(\epsilon) \simeq 2 \pi V \frac{(2 m)^{3 / 2}}{h^3} \epsilon^{1 / 2},
	\end{equation}
	但是, 要注意直接拿 $\epsilon \gg 2 \hbar \omega_L$ 计算 partition function, 等价于 $B \rightarrow 0$ (duh).
	
	\begin{tcolorbox}[title=caculation:]
		注意到 $\frac{p_z^2}{2 m} = \frac{h^2}{8 m L_z^2} n_z^2$, (其中 $L_z$ 是 $z$ 方向的长度, 不要与角动量算符 $\hat{L}_z$ 混淆)
		\begin{align}
			g(\epsilon) &= \int_0^\infty dn_r \int_{- \infty}^\infty dl \int_0^\infty dn_z \, \delta(\epsilon - \epsilon(n_r, l, n_z)) \notag \\
			&= \frac{1}{2} \sqrt{\frac{8 m L_z^2}{h^2}} \int_0^\infty dn_r \int_{- \infty}^\infty dl \, \frac{1}{\sqrt{\epsilon - \epsilon(n_r, l, 0)}} \theta(\epsilon - \epsilon(n_r, l, 0)) \notag \\
			&= \frac{1}{2} \sqrt{\frac{8 m L_z^2}{h^2}} \frac{1}{\sqrt{2 \hbar \omega_L}} \int_0^\infty dn_r \int_{- \infty}^{\frac{\epsilon}{2 \hbar \omega_L} - (n_r + \frac{1}{2})} dl \, \frac{1}{\sqrt{\frac{\epsilon}{2 \hbar \omega_L} - \big( n_r + \frac{1}{2} \big) - \frac{l + |l|}{2}}} \notag \\
			&= L_z \sqrt{\frac{m}{\hbar^3 \omega_L}} \int_0^\infty dn_r \, \Bigg( \frac{l_\text{max}}{\sqrt{\frac{\epsilon}{2 \hbar \omega_L} - \big( n_r + \frac{1}{2} \big)}} + 2 \sqrt{\frac{\epsilon}{2 \hbar \omega_L} - \big( n_r + \frac{1}{2} \big)} \Bigg) \theta(\epsilon - \epsilon(n_r, 0, 0)) \notag \\
			&= L_z \sqrt{\frac{2 \pi m}{h^3 \omega_L}} \Big( 2 l_\text{max} \sqrt{\frac{\epsilon}{2 \hbar \omega_L} - \frac{1}{2}} + \frac{4}{3} \Big( \frac{\epsilon}{2 \hbar \omega_L} - \frac{1}{2} \Big)^{\frac{3}{2}} \Big),
		\end{align}
		用经典力学估算 $l_\text{max}$, (注意 $\vec{p} = m \vec{v} - e \vec{A}$),
		\begin{equation}
			\hbar l_\text{max} = m \omega_L R_\text{max}^2 \Longrightarrow l_\text{max} = \frac{e B}{h} S_{x y},
		\end{equation}
		其中 $S_{x y} = \pi R_\text{max}^2$, 对于
		\begin{equation}
			l_\text{max} \gg \frac{\epsilon}{2 \hbar \omega_L} \gg 1,
		\end{equation}
		近似有
		\begin{equation}
			g(\epsilon) \simeq 2 \pi l_\text{max} L_z \frac{\sqrt{2 m}}{h^2 \omega_L} \epsilon^{1 / 2} = 2 \pi V \frac{(2 m)^{3 / 2}}{h^3} \epsilon^{1 / 2}.
		\end{equation}
		
		\noindent\rule[0.5ex]{\linewidth}{0.5pt} % horizontal line
		
		ladder operator 的方法与 Pathria 的方法一样,
		\begin{equation}
			\max(n_b) = l_\text{max} = L_x L_y \frac{e B}{h},
		\end{equation}
		结果一致.
		
		\noindent\rule[0.5ex]{\linewidth}{0.5pt} % horizontal line
		
		按照 Pathria 的讲法, $\epsilon = 2 \hbar \omega_L \big( j + \frac{1}{2} \big) + \frac{p_z^2}{2 m}, j \in \mathbb{Z}_{\geq 0}$, 那么,
		\begin{align}
			\frac{g(\epsilon)}{L_x L_y \frac{e B}{h}} &= \int_0^\infty dj \int_0^\infty dn_z \, \delta(\epsilon - \epsilon(j, n_z)) \notag \\
			&= \frac{1}{2} \sqrt{\frac{8 m L_z^2}{h^2}} \int_0^\infty dj \, \frac{1}{\sqrt{\epsilon - \epsilon(j, 0)}} \theta(\epsilon - \epsilon(j, 0)) \notag \\
			&= \frac{1}{2} \sqrt{\frac{8 m L_z^2}{h^2}} \frac{1}{\sqrt{2 \hbar \omega_L}} \int_0^{\frac{\epsilon}{2 \hbar \omega_L} - \frac{1}{2}} dj \, \frac{1}{\sqrt{\frac{\epsilon}{2 \hbar \omega_L} - \frac{1}{2} - j}} \notag \\
			&= L_z \sqrt{\frac{2 \pi m}{h^3 \omega_L}} 2 \sqrt{\frac{\epsilon}{2 \hbar \omega_L} - \frac{1}{2}} \simeq 2 \pi L_z \frac{\sqrt{2 m}}{h^2 \omega_L} \epsilon^{1 / 2}.
		\end{align}
	\end{tcolorbox}
\end{itemize}
