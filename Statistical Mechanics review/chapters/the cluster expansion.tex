\chapter{the cluster expansion}
\section{the Mayer f function}
\begin{itemize}
	\item 考虑具有相互作用的气体, 其 Hamiltonian 为
	\begin{equation}
		H = \sum_{i = 1}^N \frac{|\vec{p}_i|^2}{2 m} + \sum_{i > j} u(r_{i j}),
	\end{equation}
	
	\item 那么, 系统的 partition function 为
	\begin{align}
		Z_\text{C} &= \frac{1}{N! \lambda^{3 N}} \int d^{3 N} q \, e^{- \beta \sum_{i > j} u(r_{i j})} \notag \\
		&= \frac{1}{N! \lambda^{3 N}} \int d^{3 N} q \, \Big( 1 + \sum_{i > j} f_{i j} + \sum_{i > j, k > l} f_{i j} f_{k l} + \cdots \Big), \label{10.1.2}
	\end{align}
	其中 $f_{i j}$ 称为 Mayer f function, 为
	\begin{equation}
		f_{i j} := e^{- \beta u(r_{i j})} - 1.
	\end{equation}
	\begin{itemize}
		\item 注意 \eqref{10.1.2} 中的求和里, $f_{i j} f_{k l} f_{m n} \cdots$ 里不存在 identical pairs, 即 $(i, j) \neq (k, l) \neq (m, n) \neq \cdots$, 原因见 \eqref{10.1.4}.
	\end{itemize}
	
	\begin{tcolorbox}[title=proof:]
		\begin{equation} \label{10.1.4}
			e^{- \beta \sum_{i > j} u(r_{i j})} = \prod_{i > j} (1 + f_{i j}) = \cdots
		\end{equation}
	\end{tcolorbox}
\end{itemize}

\section{the cluster expansion}
\begin{itemize}
	\item 用 graphs 表示求和中的项, 以 $N = 4$ 为例,
	\begin{equation}
		1 = \vcenter{\hbox{\includegraphics[scale=1]{figures/graph of 1.pdf}}}, \quad f_{1 2} = \vcenter{\hbox{\includegraphics[scale=1]{figures/graph of f_{1 2}.pdf}}}, \quad f_{1 2} f_{2 3} = \vcenter{\hbox{\includegraphics[scale=1]{figures/graph of f_{1 2} f_{2 3}.pdf}}}, \quad f_{1 2} f_{2 3} f_{3 1} = \vcenter{\hbox{\includegraphics[scale=1]{figures/graph of f_{1 2} f_{2 3} f_{3 1}.pdf}}},
	\end{equation}
	注意到很多 graphs 有 disconnected components, 将这些 disconnected components 称为 clusters, 有 $1 \leq l \leq N$ 个 vertices 的 cluster 称为 $l$-cluster.
	\begin{itemize}
		\item 考虑 graph $G$ 由 $m_l$ 个 $l$-clusters 组成, 那么
		\begin{equation} \label{10.2.2}
			N = \sum_{l = 1}^N m_l[G] l.
		\end{equation}
	\end{itemize}
	
	\item 因此
	\begin{equation}
		\int d^{3 N} q \, \Big( 1 + \sum_{i > j} f_{i j} + \sum_{i > j, k > l} f_{i j} f_{k l} + \cdots \Big) = \sum_G W[G],
	\end{equation}
	其中 (以 $N = 4$ 为例)
	\begin{equation}
		W \Big[ \vcenter{\hbox{\includegraphics[scale=1]{figures/graph of f_{1 2}.pdf}}} \Big] = \int d^3 q_1 d^3 q_2 d^3 q_3 d^3 q_4 \, f_{1 2} = W \Big[ \vcenter{\hbox{\includegraphics[scale=1]{figures/graph of f_{1 3}.pdf}}} \Big] = \cdots
	\end{equation}
	
	\item 按 vertices 数量 (而不是 $f$ 的 powers) rearrange \eqref{10.1.2} 中的求和, 考虑
	\begin{equation}
		U_l = \int \prod_{i = 1}^l d^3 q_i \, \sum_{G \in \{l\text{-clusters}\}} G,
	\end{equation}
	注意积分不是 $d^{3 N} q$. 比如 (以 $N \sim 10^{23}$ 为例)
	\begin{equation}
		\begin{dcases}
			U_1 = V \\
			U_2 = \int d^3 q_1 d^3 q_2 \, f_{1 2} \\
			U_3 = \int d^3 q_1 d^3 q_2 d^3 q_3 \, (f_{1 2} f_{2 3} + f_{1 3} f_{3 2} + f_{2 1} f_{1 3} + f_{1 2} f_{2 3} f_{3 1})
		\end{dcases}.
	\end{equation}
	
	\item 那么
	\begin{equation}
		\boxed{\sum_{G} W[G] = N! \sum_{\{m_l\}} \prod_l \frac{U_l^{m_l}}{(l!)^{m_l} m_l!}},
	\end{equation}
	其中 $\{m_l\}$ 满足 \eqref{10.2.2}.
	
	\begin{tcolorbox}[title=proof:]
		由 $m_l$ 个 $l$-clusters 组成的 graphs 的和为
		\begin{equation}
			\prod_l U_l^{m_l},
		\end{equation}
		但是, 注意到 $U_l$ 中的 $l$ 个 vertices 是对称的, 但 $U_{l_1} \neq U_{l_2}$ 中的 vertices 互相交换会得到不同的 graph, 因此需要乘以系数
		\begin{equation}
			N! \prod_l \frac{1}{(l!)^{m_l}},
		\end{equation}
		另外 $l_1 = l_2$, 那么 $U_{l_1}, U_{l_2}$ 互相交换 (全部 $l$ 个 vertices) 会重复, 所以还需要一个系数
		\begin{equation}
		\prod_l \frac{1}{m_l!}.
		\end{equation}
	\end{tcolorbox}
	
	\item 系统的 grand partition function 为
	\begin{align}
		Z_\text{GC} &= \sum_{N = 0}^\infty z^N Z_\text{C}(N) \notag \\
		&= \sum_{N = 0}^\infty z^N \frac{1}{\lambda^{3 N}} \sum_{\{m_l | N\}} \prod_{l = 0}^N \frac{U_l^{m_l}}{(l!)^{m_l} m_l!} \notag \\
		&= \sum_{N = 0}^\infty \sum_{\{m_l | N\}} \prod_{l = 0}^N \Big( \frac{z}{\lambda^3} \Big)^{m_l l} \frac{U_l^{m_l}}{(l!)^{m_l} m_l!} = \prod_{l = 0}^\infty \sum_{m_l = 0}^\infty \Big( \frac{z}{\lambda^3} \Big)^{m_l l} \frac{U_l^{m_l}}{(l!)^{m_l} m_l!} \notag \\
		&= \prod_{l = 0}^\infty \exp \Big( \Big( \frac{z}{\lambda^3} \Big)^l \frac{U_l}{l!} \Big).
	\end{align}
\end{itemize}
